syntax = "proto3";

package juno.user;

import "identifiers.proto";

import "common.proto";

service UserService {
  rpc getUser(identifiers.UserIdentifier) returns (common.User);
  rpc getAllUsers(GetAllUsersRequest) returns (common.Users);
  rpc createUser(CreateUserRequest) returns (common.User);
  rpc updateUser(UpdateUserRequest) returns (common.User);
  rpc deleteUser(identifiers.UserIdentifier) returns (common.User);
  rpc linkProject(LinkProjectToUserRequest) returns (common.User);
  rpc unlinkProject(UnlinkProjectFromUserRequest) returns (common.User);
  rpc getUserPasswordHash(identifiers.UserIdentifier)
      returns (UserPasswordHash);
}

service AccountRequestService {
  rpc createAccountRequest(CreateNewAccountRequestMessage)
      returns (NewAccountRequest);
  rpc getAllAccountRequests(GetAllNewAccountRequestsMessage)
      returns (NewAccountRequests);
  rpc deleteAccountRequest(RemoveNewAccountRequestByIdMessage)
      returns (NewAccountRequest);
}

service UserAuthService {
  rpc authenticate(AuthenticateUserRequest) returns (common.User);
}

message UserPasswordHash { string hash = 1; }

message UserPassword { string password = 1; }


message GetAllUsersRequest {}


message CreateUserRequest {
  string email = 1;
  string name = 2;
  string password = 3;
  common.UserType type = 4;
}

message UserUpdateParams {
  optional string email = 1;
  optional string name = 2;
  optional string password = 3;
  optional common.UserType type = 4;
}

message UpdateUserRequest {
  identifiers.UserIdentifier userIdentifier = 1;
  UserUpdateParams updateParams = 2;
}

message LinkProjectToUserRequest {
  identifiers.ProjectIdentifier project = 1;
  identifiers.UserIdentifier user = 2;
}

message UnlinkProjectFromUserRequest {
  identifiers.ProjectIdentifier project = 1;
  identifiers.UserIdentifier user = 2;
}

message AuthenticateUserRequest {
  string email = 1;
  string password = 2;
}

message CreateNewAccountRequestMessage {
  string email = 1;
  string name = 2;
  string password = 3;
  common.UserType userType = 4;
  optional string projectName = 5;
}

message NewAccountRequest {
  int32 id = 1;
  string email = 2;
  string name = 3;
  common.UserType userType = 4;
  optional string projectName = 5;
  string createdAt = 6;
}

message NewAccountRequests {
  repeated NewAccountRequest requests = 1;
}

message GetAllNewAccountRequestsMessage {}

message RemoveNewAccountRequestByIdMessage {
  int32 id = 1;
}
